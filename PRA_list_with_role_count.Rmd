---
title: "NHS Business Services Authority  -  Pre-release access list"
always_allow_html: true
output:
  html_document:
    anchor_sections: no
    css: www/style.css
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: no
  word_document:
    toc: yes
    toc_depth: '3'
---
  
  <script>
    $(document).ready(function() {
      $('#header').prepend('<img src=`r knitr::image_uri("www/bsa_logo.svg")` alt=\"NHSBSA logo\" style=\"position:relative; float: right; top: 0; right: 0; padding: 10px; width: 25%;\">');
  });
</script>
  
  <style type="text/css">
  
  body, td {
    font-size: 16px;
    font-family: sans-serif;
  }
</style>
  <html lang="en">
  
```{r setup, include=FALSE}
# set code chunk options to disable echo by default

knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)


find_pra_list <- function(x) {
  file_path_of_pra_list <- file.choose()

pra_list <- readxl::read_excel(file_path_of_pra_list,
                               col_names = TRUE)

}

pra_list_org_extraction <-function (data,org) {

pra_filtered <- data |>
  dplyr::filter( Organisation == org) |>
  dplyr::group_by(Title) |>
  dplyr::summarise("Individuals per Role" = n()) |>
  dplyr::arrange(Title)

}




###########-------------- Input of publication title needed------------------------###################
name_of_publication <- "PLEASE SPECIFY PUBLICATION AND YEAR IN FIRST CODE CHUNK"


## extraction of data from excel file into a tibble 
md_pra_draft <- find_pra_list ()


```

#`r name_of_publication`

As per the ‘Statement of Compliance with Pre-release Access to Statistics Order 2008’, in addition to staff in the NHS Business Services Authority (NHSBSA) who are responsible for the production and quality assurance of the statistics, below is a list of job titles and organisations of people who have been granted 24 hours pre-release access:



### NHS Business Services Authority:




```{r}


## extracted data from tibble being filtered for NHSBSA members, summed into number of individuals per job title and arranged alphabetically

bsa_list <- pra_list_org_extraction(md_pra_draft, "NHSBSA")


## Columns filtered for title and no. professionals per role within NHS BSA

knitr::kable(bsa_list)


```


### Department of Health and Social Care:



```{r}

## extracted data from tibble being filtered for DHSC members, summed into number of individuals per job title and arranged alphabetically

DHSC_list <- pra_list_org_extraction(md_pra_draft, "DHSC")




knitr::kable (DHSC_list) 
 

```

The staff roles listed below are directly involved in the production and distribution of the statistics in this publication:

### NHS Business Services Authority:

```{r}

df <- data.frame(title = c("lead", "ssto", "sto"), "individuals per role" = c(1, 2, 2))



knitr::kable (df) 


```

